
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>FontAwesome</title>
  <link rel="stylesheet" href="./font-awesome-4.7.0/css/font-awesome.min.css">
  <style>
    *{
      margin: 0;padding: 0;
    }
    #fas{
      padding: 20px 0;
      position: relative;
      margin-right: 40px;
    }
    .item{
      display: inline-block;
      outline: 1px solid #ccc;
      padding: 3px;
      font-size: 0;
      /*user-select:none;*/
    }
    .item:hover{
      background: rgba(167, 28, 215, 0.1);
    }
    .item:hover .txt,.item:hover i{
      color: #ff3037 ;
    }
    .item .icon{
      display: inline-block;
      width: 34px;
      text-align: center;
      position: relative;
      z-index: -1;
    }
    .item i{
      font-size: 20px;
      color: #2e7bb3;
    }
    .item .txt{
      position: relative;
      z-index: -1;
      font-size: 16px;
      width: 100px;
      height: 100%;
      padding: 2px 5px;
      /*outline: none;*/
      border: none;
    }
    .trash{
      position: fixed;
      top: 20px;right: 0px;
      height: 50px;
      background: #ff5280;
    }
    .tip{
      margin-top: 20px;
      text-align: center;
    }
  </style>
</head>

<body>
  <section id="fas"  >
    <div class="item" 
    v-for="(item,indx) in items" 
    @click="selectTxt($event)" 
    @dragstart="dragstart(indx)"
    @drop="drop($event,indx)"
    @dragover="dragover" 
    draggable="true">
      <div class="icon"> <i  :class="item"></i> </div>
      <input type="text" class="txt" 
      @change="unchange(item,indx)" 
      :value="item"/>
    </div>
    
    <div class="trash">垃圾箱</div>
    <div class="tip">总共 956 个,当前 {{len}} 个</div>
  </section>
  
</body>
<script src="./jq3.1.1min.js" charset="utf-8"></script>
<script src="./vue2.3.0.js" charset="utf-8"></script>
<script type="text/javascript">
  
  var vm1 = new Vue({
    el : '#fas',
    data : {
      
      items : '',
      len : '',
      
      curStr : '',
      curIndx : '',
      
      flag : 1,
    },
    computed : { },
    watch : {
      flag : function(){
        var that = this;
        localStorage.fas = JSON.stringify(that.items);
        console.log('saved');
      },
    },
    methods : {
      selectTxt : function(e){
        $(e.srcElement).find('.txt').select();
      },
      unchange : function(txt,indx){
        console.log(txt);
        this.$set(this.items,indx,txt)
      },
      dragstart : function(indx){
        this.curStr = this.items[indx];
        this.curIndx = indx;
      },
      drop : function(e,indx){
        e.preventDefault();
        // console.log('drop',indx);
        var that = this;
        this.items.splice(that.curIndx,1);
        this.items.splice(indx,0,that.curStr)
        this.flag++;
      },
      dragover : function(e){
        e.preventDefault();
      },
    },
    mounted : function (){
      var that = this;
      this.$nextTick(function () { });
      
      
      if (!localStorage.fas) {
        $.ajax({
          type : 'get',
          url  : './data.json',
          dataType : 'json',
        })
        .done(function(backData,textStatus,obj){
          // console.log(backData);
          that.items = backData;
          that.len = backData.length;
          console.log('from data file'); 
        })
        .fail(function(xhr,status,errorTrown){
          console.log(status);
        });
      }
      else {
        that.items = JSON.parse(localStorage.fas);
        that.len = that.items.length;
        console.log('from localStorage'); 
      }
      
    },
  });
  
  
  
  
</script>
</html>





















